<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
"http://struts.apache.org/dtds/struts-2.0.dtd">

<struts>
    <constant name="struts.mapper.action.prefix.enabled" value="true" />
    <!--<constant name="struts.mapper.action.prefix.enabled" value="true" />-->
    <!-- Configuration for the default package. -->
    <package name="default" extends="struts-default">
        <action name=""> 
            <result type="chain"> 
                <param name="actionName">index</param> 
                <param name="namespace">/index</param>
            </result> 
        </action>
    </package>
    
    <package name="index" namespace="/index" extends="struts-default">
        <action name="index">
            <result>/login.jsp</result>
        </action>
        <action name="mainPage">
            <result>/home.jsp</result>
        </action>
    </package>
    
    <package name="login" namespace="/login" extends="struts-default">        
        <action name="login" class="actions.LoginAction">
            <result name="success" type="chain">
                <param name="actionName">loadStudentHome</param>
            </result>
            <result name="success_admin" type="redirectAction">
                <param name="actionName">loadStudents</param>
                <param name="namespace">/admin</param>
            </result>     
            <result name="success_alumno">home.jsp</result>
            <result name="success_prof">home.jsp</result>
            <result name="input">/login.jsp</result>
            <result name="error">/login.jsp</result>            
        </action>
        
        <!--
        TODO: El logout siempre da un input, asi que lo he reenvio al principio
        -->
        <action name="logout" class="actions.LoginAction" method="logout">
            <result name="success">/login.jsp</result>
            <result name="input" type="chain">
                <param name="actionName">index</param> 
                <param name="namespace">/index</param>
            </result>
            <result name="error">/error.jsp</result>            
        </action>
        
        <!-- <action name="admin_nav_students" class="AdminNavAction" method="goToStudents">
            <result name="success">/</result>
        </action> -->
        
    </package>
    
    <package name="asignatura" namespace="/asignaturas" extends="struts-default">
        
        <action name="loadAsignatura" class="actions.AsignaturaActions">
            <result name="success">/class.jsp</result>
        </action>
        <action name="alumnosAsignatura" class="actions.AsignaturaActions" method="allAlumnos">
            <result name="success">/class_alumnos.jsp</result>
        </action>
        
    </package>
    
    <package name="material" namespace="/materiales" extends="struts-default">
        
        <action name="loadMaterial" class="actions.MaterialActions">
            <result name="success">/student_material.jsp</result>
        </action>
        
        <action name="getMaterial" class="actions.MaterialActions" method="download">
            <result name="success">/student_material.jsp</result>
        </action>
        
    </package>
    
    <package name="messages" namespace="/messages" extends="struts-default">        
        <action name="loadMessages" class="actions.MessagesActions" method="loadAlumnos">
            <result name="success">/messages.jsp</result>
            <result name="input">/messages.jsp</result>
        </action>        
        <action name="send" class="actions.MessagesActions" method="sendMessage">
            <result name="success">/postredirectget.jsp</result>
            <result name="input">/messages.jsp</result>
        </action>        
    </package>
    
    <package name="admin" namespace="/admin" extends="struts-default">
        <action name="loadStudents" class="actions.admin.AlumnosCRUDActions" method="loadAlumnos">
            <result name="success">/admin_alumnos.jsp</result>
        </action>
        <action name="crearAlumno" class="actions.admin.AlumnosCRUDActions" method="crearAlumno">
            <result name="success">/postredirectget.jsp</result>
            <result name="input">/admin_alumnos.jsp</result>
        </action>      
        <action name="editarAlumno" class="actions.admin.AlumnosCRUDActions" method="editarAlumno">
            <result name="success">/admin_alumnos.jsp</result>
        </action>
        <action name="editarAlumno" class="actions.admin.AlumnosCRUDActions" method="editarAlumno">
            <result name="success" type="redirectAction">
                <param name="actionName">loadStudents</param>
                <param name="namespace">/admin</param>
            </result>
            <result name="input">/admin_alumnos.jsp</result>
        </action>  
        
        <action name="loadTeachers" class="actions.admin.ProfesoresCRUDActions" method="loadProfesores">
            <result name="success">/admin_profesores.jsp</result>
        </action>
        <action name="loadCourses" class="actions.admin.AsignaturasCRUDActions" method="loadAsignaturas">
            <result name="success">/admin_asignaturas.jsp</result>
        </action>
        <action name="loadRooms" class="actions.admin.AulasCRUDActions" method="loadAulas">
            <result name="success">/admin_aulas.jsp</result>
        </action>
    </package>
</struts>
